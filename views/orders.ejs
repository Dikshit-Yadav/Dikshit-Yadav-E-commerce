<!DOCTYPE html>
<html>
<head>
  <title>My Orders</title>
  <link href="/css/style.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body class="bg-gray-100">
  <%- include('partials/navbar', { userRole: userRole }) %>

  <div class="p-6">
    <h1 class="text-2xl font-bold mb-4">My Orders</h1>
    <% if (orders.length === 0) { %>
      <p class="text-gray-600">You have no orders yet.</p>
    <% } else { %>
      <% orders.forEach(order => { %>
        <div class="bg-white p-4 mb-4 shadow rounded">
          <h2 class="font-bold">Order #<%= order._id %></h2>
          <p>Status: <%= order.status %></p>
          <ul class="mt-2">
          <% order.products.forEach(item => { %>
  <% if (item.productId) { %>
    <li class="flex items-center gap-2">
    <img src="/uploads/<%= item.productId.image %>" alt="" class="w-10 h-10 object-cover rounded">
    <span><%= item.productId.name %> x <%= item.quantity %></span><br>
  </li>
  <a href="/orders/<%= order._id %>" class="text-blue-600 underline cursor-pointer">See details</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <form action="/delete/<%= order._id %>?_method=DELETE" method="post">
    <button class="bg-blue-600 text-white px-4 py-2 mt-2 rounded">Cancel Order</button>
  </form>
  <% } else { %>
    <li class="text-red-600">[Product no longer available] x <%= item.quantity %></li>
  <% } %>
<% }) %>

          </ul>
          <p class="mt-2 font-bold">Total: â‚¹<%= order.totalPrice %></p>
        </div>
      <% }) %>
    <% } %>
  </div>
  <%- include('partials/footer') %>
</body>
</html>

